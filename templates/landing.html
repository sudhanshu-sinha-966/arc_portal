<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Academic Research Collaboration | Landing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary: #1e3c72;
      --accent: #fbc2eb;
      --card-bg: rgba(255,255,255,0.07);
      --input-bg: rgba(255,255,255,0.13);
      --input-focus: rgba(255,255,255,0.19);
      --shadow: 0 8px 40px 0 #0003;
      --radius: 18px;
    }
    body {
      min-height: 100vh;
      background: linear-gradient(120deg, #232526 0%, #485563 100%);
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      color: #fff;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    .container {
      display: flex;
      height: 100vh;
      width: 100vw;
    }
    /* Left Section */
    .left-section {
      flex: 2;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--primary) 0%, #2a5298 100%);
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 80px 0 var(--primary) inset;
    }
    .text-slider {
      width: 80%;
      max-width: 600px;
      min-height: 350px;
      position: relative;
      z-index: 2;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .project-title {
      font-size: 3.2rem;
      font-weight: 800;
      letter-spacing: 2px;
      margin-bottom: 2rem;
      background: linear-gradient(90deg, #fff 60%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 4px 24px #0005;
      animation: fadeInDown 1.2s cubic-bezier(.77,0,.18,1) 0.2s both;
    }
    .slide-texts {
      position: relative;
      min-height: 110px;
      margin-bottom: 2.2rem;
    }
    .slide-text {
      opacity: 0;
      position: absolute;
      left: 0; right: 0; top: 0;
      font-size: 1.35rem;
      line-height: 1.7;
      background: rgba(255,255,255,0.07);
      border-radius: 12px;
      padding: 1.5rem 1.2rem;
      box-shadow: 0 2px 16px 0 #0002;
      backdrop-filter: blur(1.5px);
      transition: opacity 0.7s, transform 0.7s;
      transform: translateY(30px);
      pointer-events: none;
    }
    .slide-text.active {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
      position: relative;
    }
    .slider-dots {
      display: flex;
      gap: 8px;
      margin-top: 1rem;
      justify-content: flex-start;
    }
    .slider-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #fff3;
      cursor: pointer;
      transition: background 0.2s;
    }
    .slider-dot.active {
      background: #fff;
      box-shadow: 0 0 8px 2px #fff8;
    }
    .left-section svg {
      position: absolute;
      bottom: -40px;
      right: -60px;
      width: 350px;
      opacity: 0.13;
      z-index: 1;
      pointer-events: none;
    }
    /* Right Section */
    .right-section {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(30,35,60,0.82);
      box-shadow: -8px 0 32px 0 #0004;
      position: relative;
      overflow: hidden;
    }
    .auth-card {
      width: 92%;
      max-width: 370px;
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 2.5rem 2rem;
      backdrop-filter: blur(6px);
      position: relative;
      overflow: hidden;
      animation: fadeInRight 1.1s cubic-bezier(.77,0,.18,1) 0.3s both;
      transition: min-height 0.4s;
      min-height: 320px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .auth-toggle-group {
      display: flex;
      justify-content: center;
      gap: 18px;
      margin-bottom: 2.2rem;
      margin-top: 0.5rem;
    }
    .auth-toggle-btn {
      padding: 0.8rem 2.2rem;
      font-size: 1.07rem;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      background: rgba(255,255,255,0.13);
      color: #fff;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      box-shadow: 0 1px 6px 0 #0001;
      outline: none;
    }
    .auth-toggle-btn.active,
    .auth-toggle-btn:hover {
      background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
      color: #fff;
    }
    .role-select-group {
      display: flex;
      justify-content: center;
      gap: 18px;
      margin-bottom: 1.8rem;
      margin-top: 0.5rem;
    }
    .role-select-btn {
      padding: 0.7rem 1.6rem;
      font-size: 1.03rem;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      background: rgba(255,255,255,0.09);
      color: #fff;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      box-shadow: 0 1px 6px 0 #0001;
      outline: none;
    }
    .role-select-btn.active,
    .role-select-btn:hover {
      background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
      color: #fff;
    }
    .auth-form {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      width: 100%;
      transition: opacity 0.5s, transform 0.5s;
    }
    .auth-form input[type="email"], .auth-form input[type="text"], .auth-form input[type="password"] {
      background: var(--input-bg);
      border: none;
      border-radius: 8px;
      padding: 0.85rem 1rem;
      font-size: 1.05rem;
      color: #fff;
      outline: none;
      transition: background 0.2s, box-shadow 0.2s;
      box-shadow: 0 1px 6px 0 #0001;
    }
    .auth-form input:focus {
      background: var(--input-focus);
      box-shadow: 0 2px 16px 0 var(--accent);
    }
    .auth-form button {
      background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.9rem 0;
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 1px;
      cursor: pointer;
      margin-top: 0.6rem;
      box-shadow: 0 2px 12px 0 #fbc2eb55;
      transition: background 0.2s, transform 0.12s;
    }
    .auth-form button:active {
      transform: scale(0.97);
    }
    .auth-form .error {
      color: #ff6b81;
      font-size: 0.97rem;
      min-height: 22px;
      letter-spacing: 0.1px;
      text-align: center;
    }
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-40px);}
      to { opacity: 1; transform: translateY(0);}
    }
    @keyframes fadeInRight {
      from { opacity: 0; transform: translateX(60px);}
      to { opacity: 1; transform: translateX(0);}
    }
    @media (max-width: 900px) {
      .container { flex-direction: column; }
      .left-section, .right-section { flex: unset; width: 100vw; height: 50vh; }
      .left-section { min-height: 320px; }
      .right-section { min-height: 320px; }
      .auth-card { margin: 2rem auto; }
    }
    @media (max-width: 600px) {
      .left-section { min-height: 220px; }
      .right-section { min-height: 320px; }
      .project-title { font-size: 2.1rem; }
      .slide-text { font-size: 1.05rem; }
      .auth-card { padding: 1.5rem 0.9rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Left: Animated Text Section -->
    <div class="left-section">
      <div class="text-slider">
        <div class="project-title">Academic Research Collaboration</div>
        <div class="slide-texts">
          <div class="slide-text active">
            <b>Connect. Collaborate. Create.</b><br>
            A premium platform bridging <span style="color:#fbc2eb;font-weight:600;">students</span> and <span style="color:#fbc2eb;font-weight:600;">professors</span> for academic research opportunities.
          </div>
          <div class="slide-text">
            <b>Explore Projects</b><br>
            Professors post research topics, required skills, and project details. Students browse and discover opportunities tailored to their interests.
          </div>
          <div class="slide-text">
            <b>Apply &amp; Get Matched</b><br>
            Submit your profile, get shortlisted, and join cutting-edge research teams. Transparent workflow and real-time updates at every step.
          </div>
          <div class="slide-text">
            <b>Seamless Communication</b><br>
            Built-in messaging and notifications keep you connected. Foster meaningful academic collaborations and elevate your research journey.
          </div>
        </div>
        <div class="slider-dots">
          <div class="slider-dot active"></div>
          <div class="slider-dot"></div>
          <div class="slider-dot"></div>
          <div class="slider-dot"></div>
        </div>
      </div>
      <!-- Decorative SVG -->
      <svg viewBox="0 0 200 200">
        <path fill="#fbc2eb" d="M54.6,-62.5C69.1,-49.3,77.8,-28.3,77.9,-7.5C78,13.3,69.5,33.8,55,46.5C40.5,59.3,20.2,64.3,-0.6,64.7C-21.4,65.1,-42.9,61,-54.5,48.2C-66.1,35.4,-67.8,13.8,-63.2,-6.4C-58.6,-26.5,-47.7,-45.1,-32.1,-58.2C-16.5,-71.3,3.8,-79,23.6,-77.9C43.5,-76.8,62.1,-66.7,54.6,-62.5Z" transform="translate(100 100)" />
      </svg>
    </div>
    <!-- Right: Auth Section -->
    <div class="right-section">
      <div class="auth-card" id="authCard">
        <div class="auth-toggle-group">
          <button class="auth-toggle-btn active" id="showLoginBtn">Login</button>
          <button class="auth-toggle-btn" id="showRegisterBtn">Register</button>
        </div>

        <!-- Login Role Select -->
        <div id="loginRoleSelect" style="display:none;">
          <h2 style="text-align:center;">Login As</h2>
          <div class="role-select-group">
            <button class="role-select-btn" id="loginStudentBtn">Student</button>
            <button class="role-select-btn" id="loginProfessorBtn">Professor</button>
          </div>
        </div>

        <!-- Login Form -->
        <form class="auth-form" id="loginForm" autocomplete="off" method="POST" action="/login" style="display:none;">
          <h2 style="text-align:center;">Login</h2>
          <input type="email" id="loginEmail" name="email" placeholder="Institutional Email" required autocomplete="username">
          <input type="password" id="loginPassword" name="password" placeholder="Password" required autocomplete="current-password">
          <input type="hidden" name="role" id="loginRoleInput" value="">
          <div class="error" id="loginError">
            {% if login_error %}{{ login_error }}{% endif %}
            {% if role_mismatch and suggested_role %}
            <div class="role-suggestion" style="margin-top: 10px; padding: 10px; background: rgba(255,193,7,0.2); border: 1px solid #ffc107; border-radius: 8px; color: #fff;">
              <strong>💡 Quick Fix:</strong> 
              <button type="button" id="switchRoleBtn" data-role="{{ suggested_role }}" 
                      style="background: #ffc107; color: #000; border: none; padding: 5px 10px; border-radius: 4px; margin-left: 10px; cursor: pointer; font-weight: bold;">
                Switch to {{ suggested_role.title() }}
              </button>
            </div>
            {% endif %}
          </div>
          <button type="submit">Login</button>
        </form>

        <!-- Register Role Select -->
        <div id="registerRoleSelect" style="display:none;">
          <h2 style="text-align:center;">Register As</h2>
          <div class="role-select-group">
            <button class="role-select-btn" id="registerStudentBtn">Student</button>
            <button class="role-select-btn" id="registerProfessorBtn">Professor</button>
          </div>
        </div>

        <!-- Register Student Form -->
        <form class="auth-form" id="registerStudentForm" autocomplete="off" method="POST" action="/register/student" style="display:none;">
          <h2 style="text-align:center;">Student Registration</h2>
          <input type="text" name="name" placeholder="Full Name" required>
          <input type="email" name="email" placeholder="Institutional Email" required>
          <input type="password" name="password" placeholder="Password" required>
          <input type="password" name="confirm_password" placeholder="Confirm Password" required>
          <div class="error" id="registerStudentError">{% if register_student_error %}{{ register_student_error }}{% endif %}</div>
          {% if register_student_success %}
          <div class="success" style="color: #3ecf8e; font-size: 0.97rem; min-height: 22px; letter-spacing: 0.1px; text-align: center;">{{ register_student_success }}</div>
          {% endif %}
          <button type="submit">Register as Student</button>
        </form>

        <!-- Register Professor Form -->
        <form class="auth-form" id="registerProfessorForm" autocomplete="off" method="POST" action="/register/professor" style="display:none;">
          <h2 style="text-align:center;">Professor Registration</h2>
          <input type="text" name="name" placeholder="Full Name" required>
          <input type="email" name="email" placeholder="Institutional Email" required>
          <input type="password" name="password" placeholder="Password" required>
          <input type="password" name="confirm_password" placeholder="Confirm Password" required>
          <div class="error" id="registerProfessorError">{% if register_professor_error %}{{ register_professor_error }}{% endif %}</div>
          <button type="submit" id="profRegisterBtn">Register as Professor</button>
        </form>
      </div>
    </div>
  </div>
  <script>
    // --- Text Slider Logic ---
    const slides = document.querySelectorAll('.slide-text');
    const dots = document.querySelectorAll('.slider-dot');
    let currentSlide = 0;
    let slideInterval = setInterval(nextSlide, 4200);

    function showSlide(idx) {
      slides.forEach((slide, i) => {
        slide.classList.toggle('active', i === idx);
        dots[i].classList.toggle('active', i === idx);
      });
      currentSlide = idx;
    }

    function nextSlide() {
      let next = (currentSlide + 1) % slides.length;
      showSlide(next);
    }

    dots.forEach((dot, i) => {
      dot.addEventListener('click', () => {
        clearInterval(slideInterval);
        showSlide(i);
        slideInterval = setInterval(nextSlide, 4200);
      });
    });

    // --- Auth/Role Toggling Logic ---

const showLoginBtn = document.getElementById('showLoginBtn');
const showRegisterBtn = document.getElementById('showRegisterBtn');

const loginRoleSelect = document.getElementById('loginRoleSelect');
const loginStudentBtn = document.getElementById('loginStudentBtn');
const loginProfessorBtn = document.getElementById('loginProfessorBtn');
const loginForm = document.getElementById('loginForm');
const loginRoleInput = document.getElementById('loginRoleInput');  // Hidden input for role

const registerRoleSelect = document.getElementById('registerRoleSelect');
const registerStudentBtn = document.getElementById('registerStudentBtn');
const registerProfessorBtn = document.getElementById('registerProfessorBtn');
const registerStudentForm = document.getElementById('registerStudentForm');
const registerProfessorForm = document.getElementById('registerProfessorForm');

// Utility: Show only the passed elements, hide the rest
function setVisibility(visibleBlock) {
  const all = [
    loginRoleSelect, loginForm,
    registerRoleSelect, registerStudentForm, registerProfessorForm
  ];
  all.forEach(el => el.style.display = 'none');
  if (visibleBlock) visibleBlock.style.display = (visibleBlock.tagName === 'FORM' ? 'flex' : 'block');
}

// --- Auth tab toggles ---
showLoginBtn.onclick = function() {
  showLoginBtn.classList.add('active');
  showRegisterBtn.classList.remove('active');
  setVisibility(loginRoleSelect);
};

showRegisterBtn.onclick = function() {
  showRegisterBtn.classList.add('active');
  showLoginBtn.classList.remove('active');
  setVisibility(registerRoleSelect);
};

// --- Login Role selection ---
loginStudentBtn.onclick = function() {
  loginStudentBtn.classList.add('active');
  loginProfessorBtn.classList.remove('active');
  loginRoleInput.value = 'student';
  setVisibility(loginForm);
};
loginProfessorBtn.onclick = function() {
  loginProfessorBtn.classList.add('active');
  loginStudentBtn.classList.remove('active');
  loginRoleInput.value = 'professor';
  setVisibility(loginForm);
};

// --- Register Role selection ---
registerStudentBtn.onclick = function() {
  registerStudentBtn.classList.add('active');
  registerProfessorBtn.classList.remove('active');
  setVisibility(registerStudentForm);
};
registerProfessorBtn.onclick = function() {
  registerProfessorBtn.classList.add('active');
  registerStudentBtn.classList.remove('active');
  setVisibility(registerProfessorForm);
};

// Handle role switch button for role mismatch
const switchRoleBtn = document.getElementById('switchRoleBtn');
if (switchRoleBtn) {
  switchRoleBtn.onclick = function() {
    const suggestedRole = this.getAttribute('data-role');
    // Clear error message
    document.getElementById('loginError').innerHTML = '';
    
    // Switch to the suggested role
    if (suggestedRole === 'student') {
      loginStudentBtn.click();
    } else if (suggestedRole === 'professor') {
      loginProfessorBtn.click();
    }
  };
}

// --- On page load, show login by default or handle success redirect ---
// Check if there's a success message to auto-redirect to login
const hasStudentSuccess = document.querySelector('.success');
const hasRoleMismatch = document.querySelector('.role-suggestion');

if (hasRoleMismatch) {
  // If there's a role mismatch, show login form directly
  showLoginBtn.click();
  setTimeout(() => {
    setVisibility(loginForm);
  }, 100);
} else if (hasStudentSuccess) {
  // If student registration was successful, show login form
  showLoginBtn.click();
  setTimeout(() => {
    loginStudentBtn.click();
  }, 100);
} else {
  showLoginBtn.click();
}

// --- OPTIONAL: Error/success message auto-clear on any tab switch (improve UX) ---
function clearMessages() {
  const errorEls = document.querySelectorAll('.error, .success');
  errorEls.forEach(el => el.textContent = '');
}
['showLoginBtn', 'showRegisterBtn', 'loginStudentBtn', 'loginProfessorBtn', 'registerStudentBtn', 'registerProfessorBtn'].forEach(id => {
  const btn = document.getElementById(id);
  if (btn) btn.addEventListener('click', clearMessages);
});

// --- End Refactored JS ---

  </script>
</body>
</html>
